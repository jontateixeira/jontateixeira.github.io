<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="listing code">
<meta name="viewport" content="width=device-width">
<title>Listings for nonlinear dynamics purpose | YHWH Dwells in my heart</title>
<link href="../assets/css/bitter.css" rel="stylesheet" type="text/css">
<link href="../assets/css/main.css" rel="stylesheet" type="text/css">
<link href="../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="http://jontateixeira.github.io/listings-nonlinear/">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script><meta name="author" content="Jonathan C. Teixeira">
<meta property="og:site_name" content="YHWH Dwells in my heart">
<meta property="og:title" content="Listings for nonlinear dynamics purpose">
<meta property="og:url" content="http://jontateixeira.github.io/listings-nonlinear/">
<meta property="og:description" content="listing code">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-12-10T10:16:20-03:00">
<meta name="author" content="Jonathan C. Teixeira">
<meta property="og:site_name" content="YHWH Dwells in my heart">
<meta property="og:title" content="Listings for nonlinear dynamics purpose">
<meta property="og:url" content="http://jontateixeira.github.io/listings-nonlinear/">
<meta property="og:description" content="listing code">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-12-10T10:16:20-03:00">
<meta name="description" itemprop="description" content="listing code">
</head>
<body>
    <section class="social"><ul>
<li><a href="../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="http://lattes.cnpq.br/2372591257623213" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="https://www.linkedin.com/in/jonathanteixeira/" title="LinkedIn"><i class="icon-linkedin"></i></a></li>
            <li><a href="https://github.com/jontateixeira" title="My Github"><i class="icon-github"></i></a></li>
            <li><a href="../posts/index.html" title="Posts"><i class="icon-edit"></i></a></li>
            <li><a href="../archive.html" title="Archive"><i class="icon-archive"></i></a></li>
            <li><a href="../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
<article class="storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name">Listings for nonlinear dynamics purpose</h1>

        
    </header><div itemprop="articleBody text">
    <p>All codes used for produce the nonlinear dynamic posts</p>
<ul class="simple">
<li><p>Plot the phase portrait:</p></li>
</ul>
<p><a class="reference external" href="../listings/phasePortrait.m.html">phasePortrait.m</a>  <a class="reference external" href="../listings/phasePortrait.m">(Source)</a></p>
<div class="code"><pre class="code matlab"><a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-1" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-1" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-1"></a><span class="k">function</span><span class="w"> </span><span class="nf">phasePortrait</span><span class="p">(</span>fun, lb, ub, n, randomize<span class="p">)</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-2" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-2" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-2"></a><span class="c">%Create a phase portrait from a two-dimensional system of ode</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-3" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-3" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-3"></a><span class="c">%</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-4" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-4" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-4"></a><span class="c">% SYNOPSIS:</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-5" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-5" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-5"></a><span class="c">%   phasePortrait(fun, lb, ub, n, randomize)</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-6" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-6" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-6"></a><span class="c">%</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-7" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-7" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-7"></a><span class="c">% PARAMETERS:</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-8" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-8" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-8"></a><span class="c">%   fun         - Function handle or function name with the system of ode</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-9" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-9" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-9"></a><span class="c">%   lb          - lower bound of phase portrait</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-10" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-10" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-10"></a><span class="c">%   ub          - upper bound of phase portrait</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-11" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-11" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-11"></a><span class="c">%   n           - number of intial condition of system</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-12" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-12" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-12"></a><span class="c">%   randomize   - logical variable to randomize the initial points to integrate</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-13" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-13" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-13"></a><span class="c">%                 the system. OPTIONAL.  Default value == true</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-14" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-14" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-14"></a><span class="c">%</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-15" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-15" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-15"></a><span class="c">% RETURNS:</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-16" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-16" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-16"></a><span class="c">%   phase portrait plot</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-17" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-17" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-17"></a><span class="c">%</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-18" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-18" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-18"></a><span class="c">% EXAMPLE:</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-19" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-19" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-19"></a><span class="c">%</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-20" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-20" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-20"></a>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-21" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-21" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-21"></a><span class="k">if</span><span class="w"> </span><span class="nb">nargin</span><span class="o">&lt;</span><span class="mi">4</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-22" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-22" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-22"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-23" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-23" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-23"></a><span class="w">  </span><span class="n">randomize</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-24" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-24" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-24"></a><span class="k">elseif</span><span class="w"> </span><span class="nb">nargin</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-25" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-25" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-25"></a><span class="w">  </span><span class="n">randomize</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-26" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-26" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-26"></a><span class="k">end</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-27" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-27" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-27"></a>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-28" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-28" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-28"></a><span class="n">num</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-29" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-29" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-29"></a><span class="n">dx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">ub</span><span class="o">-</span><span class="n">lb</span><span class="p">)</span><span class="o">/</span><span class="n">num</span><span class="p">;</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-30" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-30" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-30"></a>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-31" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-31" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-31"></a><span class="p">[</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">]=</span><span class="nb">meshgrid</span><span class="p">(</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span><span class="n">ub</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span><span class="n">dx</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span><span class="n">ub</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-32" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-32" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-32"></a>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-33" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-33" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-33"></a><span class="n">v</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="nb">numel</span><span class="p">(</span><span class="n">x1</span><span class="p">(:)),</span><span class="mi">2</span><span class="p">);</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-34" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-34" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-34"></a><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">x1</span><span class="p">(:))</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-35" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-35" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-35"></a><span class="w">   </span><span class="n">v</span><span class="p">(</span><span class="nb">i</span><span class="p">,:)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">fun</span><span class="p">([</span><span class="n">x1</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span><span class="w"> </span><span class="n">x2</span><span class="p">(</span><span class="nb">i</span><span class="p">)]);</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-36" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-36" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-36"></a><span class="k">end</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-37" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-37" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-37"></a>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-38" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-38" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-38"></a><span class="nb">figure</span><span class="p">()</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-39" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-39" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-39"></a><span class="nb">disp</span><span class="p">(</span><span class="s">'vectorial field'</span><span class="p">)</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-40" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-40" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-40"></a><span class="nb">hold</span><span class="w"> </span><span class="n">on</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-41" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-41" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-41"></a><span class="nb">quiver</span><span class="p">(</span><span class="n">x1</span><span class="p">(:),</span><span class="n">x2</span><span class="p">(:),</span><span class="n">v</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">v</span><span class="p">(:,</span><span class="mi">2</span><span class="p">));</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-42" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-42" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-42"></a><span class="k">if</span><span class="w"> </span><span class="n">randomize</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-43" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-43" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-43"></a><span class="w">  </span><span class="n">u</span><span class="p">=</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">ub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="nb">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-44" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-44" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-44"></a><span class="w">  </span><span class="n">v</span><span class="p">=</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">ub</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="nb">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-45" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-45" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-45"></a><span class="k">else</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-46" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-46" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-46"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">floor</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-47" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-47" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-47"></a><span class="w">  </span><span class="n">u</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ub</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">n</span><span class="p">);</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-48" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-48" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-48"></a><span class="w">  </span><span class="n">u</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="nb">repmat</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">repmat</span><span class="p">(</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="nb">repmat</span><span class="p">(</span><span class="n">ub</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)];</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-49" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-49" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-49"></a><span class="w">  </span><span class="n">v</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ub</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">n</span><span class="p">);</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-50" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-50" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-50"></a><span class="w">  </span><span class="n">v</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="nb">repmat</span><span class="p">(</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="nb">repmat</span><span class="p">(</span><span class="n">ub</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="nb">repmat</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)];</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-51" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-51" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-51"></a><span class="k">end</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-52" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-52" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-52"></a>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-53" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-53" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-53"></a><span class="n">funcao</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">fun</span><span class="p">([</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-54" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-54" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-54"></a><span class="nb">disp</span><span class="p">(</span><span class="s">'tracing paths ...'</span><span class="p">)</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-55" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-55" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-55"></a><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-56" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-56" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-56"></a><span class="w">    </span><span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">sol</span><span class="p">]=</span><span class="nb">ode45</span><span class="p">(</span><span class="n">funcao</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],[</span><span class="n">u</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span><span class="n">v</span><span class="p">(</span><span class="nb">i</span><span class="p">)]);</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-57" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-57" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-57"></a><span class="w">    </span><span class="nb">plot</span><span class="p">(</span><span class="n">sol</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">sol</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span><span class="s">'k'</span><span class="p">);</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-58" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-58" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-58"></a><span class="k">end</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-59" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-59" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-59"></a><span class="nb">hold</span><span class="w"> </span><span class="n">off</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-60" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-60" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-60"></a>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-61" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-61" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-61"></a><span class="nb">xlim</span><span class="p">([</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">ub</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<a id="rest_code_71d19085a70e42c0a6325e33e7f5de32-62" name="rest_code_71d19085a70e42c0a6325e33e7f5de32-62" href="#rest_code_71d19085a70e42c0a6325e33e7f5de32-62"></a><span class="nb">ylim</span><span class="p">([</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">ub</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
</pre></div>
<ul class="simple">
<li><p>Images of the posts <a class="reference external" href="../posts/phase-portrait/">Nonlinear dynamics 1: Phase portrait</a>:</p></li>
</ul>
<p><a class="reference external" href="../listings/post_phase_portrait.m.html">post_phase_portrait.m</a>  <a class="reference external" href="../listings/post_phase_portrait.m">(Source)</a></p>
<div class="code"><pre class="code matlab"><a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-1" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-1" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-1"></a><span class="cm">%{</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-2" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-2" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-2"></a><span class="cm">File: test_phasePortrait.m</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-3" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-3" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-3"></a><span class="cm">Author: Jonathan C. Teixeira</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-4" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-4" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-4"></a><span class="cm">Email: jonta.teixeira@gmail.com</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-5" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-5" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-5"></a><span class="cm">Description: Generate phase portrait of ode system</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-6" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-6" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-6"></a><span class="cm">%}</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-7" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-7" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-7"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-8" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-8" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-8"></a><span class="c">% as usual</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-9" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-9" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-9"></a><span class="nb">clc</span><span class="p">;</span><span class="w"> </span><span class="nb">clear</span><span class="p">;</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="s">all</span><span class="p">;</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-10" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-10" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-10"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-11" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-11" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-11"></a><span class="n">ode</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">'nonlinear'</span><span class="p">;</span><span class="w">    </span><span class="c">% ode selections: 'linear' or 'nonlinear'</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-12" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-12" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-12"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-13" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-13" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-13"></a><span class="k">switch</span><span class="w"> </span><span class="nb">lower</span><span class="p">(</span><span class="n">ode</span><span class="p">)</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-14" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-14" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-14"></a><span class="k">case</span><span class="w"> </span><span class="s">'linear'</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-15" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-15" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-15"></a><span class="w">    </span><span class="c">% homogeneous linear system</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-16" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-16" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-16"></a><span class="w">    </span><span class="c">% name of variables</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-17" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-17" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-17"></a><span class="w">    </span><span class="n">varname</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="s">'x'</span><span class="p">,</span><span class="w"> </span><span class="s">'y'</span><span class="p">};</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-18" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-18" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-18"></a><span class="w">    </span><span class="n">portrait_lim</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]};</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-19" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-19" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-19"></a><span class="w">    </span><span class="n">num_curves</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-20" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-20" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-20"></a><span class="w">    </span><span class="p">[</span><span class="n">x0</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">deal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-21" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-21" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-21"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-22" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-22" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-22"></a><span class="w">    </span><span class="n">a</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-23" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-23" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-23"></a><span class="w">    </span><span class="n">b</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="o">+</span><span class="mi">5</span><span class="p">];</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-24" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-24" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-24"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-25" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-25" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-25"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-26" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-26" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-26"></a><span class="w">      </span><span class="c">% define ode system</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-27" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-27" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-27"></a><span class="w">      </span><span class="n">dy</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">a</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">))];</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-28" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-28" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-28"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-29" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-29" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-29"></a><span class="w">      </span><span class="c">% plot phase portrait</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-30" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-30" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-30"></a><span class="w">      </span><span class="n">phasePortrait</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span><span class="n">portrait_lim</span><span class="p">{</span><span class="mi">1</span><span class="p">},</span><span class="n">portrait_lim</span><span class="p">{</span><span class="mi">2</span><span class="p">},</span><span class="n">num_curves</span><span class="p">)</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-31" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-31" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-31"></a><span class="w">      </span><span class="nb">hold</span><span class="w"> </span><span class="n">on</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-32" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-32" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-32"></a><span class="w">      </span><span class="nb">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="s">'sr'</span><span class="p">);</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-33" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-33" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-33"></a><span class="w">      </span><span class="nb">xlabel</span><span class="p">(</span><span class="n">varname</span><span class="p">{</span><span class="mi">1</span><span class="p">});</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="n">varname</span><span class="p">{</span><span class="mi">2</span><span class="p">});</span><span class="w"> </span><span class="n">grid</span><span class="w"> </span><span class="s">on</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-34" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-34" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-34"></a><span class="w">      </span><span class="nb">print</span><span class="p">(</span><span class="s">'-dpng'</span><span class="p">,</span><span class="w"> </span><span class="s">'-r300'</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s">'phase_portrait_'</span><span class="p">,</span><span class="n">ode</span><span class="p">,</span><span class="s">'_'</span><span class="p">,</span><span class="nb">num2str</span><span class="p">(</span><span class="nb">i</span><span class="p">)]);</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-35" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-35" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-35"></a><span class="w">    </span><span class="k">end</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-36" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-36" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-36"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-37" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-37" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-37"></a><span class="k">case</span><span class="w"> </span><span class="s">'nonlinear'</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-38" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-38" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-38"></a><span class="w">    </span><span class="c">%% nonlinear system</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-39" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-39" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-39"></a><span class="w">    </span><span class="c">% parameter definition</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-40" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-40" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-40"></a><span class="w">    </span><span class="n">tau</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">60</span><span class="p">;</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-41" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-41" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-41"></a><span class="w">    </span><span class="n">k0</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="mf">1.7e5</span><span class="p">;</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-42" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-42" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-42"></a><span class="w">    </span><span class="n">G</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="mf">90.3</span><span class="p">;</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-43" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-43" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-43"></a><span class="w">    </span><span class="n">E_R</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">6307</span><span class="p">;</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-44" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-44" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-44"></a><span class="w">    </span><span class="n">Ca0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1.5</span><span class="p">;</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-45" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-45" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-45"></a><span class="w">    </span><span class="n">T0</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="mi">350</span><span class="p">,</span><span class="mi">12</span><span class="p">);</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-46" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-46" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-46"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-47" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-47" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-47"></a><span class="w">    </span><span class="c">% name of variables</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-48" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-48" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-48"></a><span class="w">    </span><span class="n">varname</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="s">'Concentration'</span><span class="p">,</span><span class="w"> </span><span class="s">'Temperature'</span><span class="p">};</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-49" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-49" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-49"></a><span class="w">    </span><span class="n">portrait_lim</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">550</span><span class="p">]};</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-50" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-50" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-50"></a><span class="w">    </span><span class="n">num_curves</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">300</span><span class="p">;</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-51" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-51" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-51"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-52" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-52" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-52"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">T0</span><span class="p">)</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-53" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-53" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-53"></a><span class="w">        </span><span class="c">% define ode system</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-54" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-54" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-54"></a><span class="w">        </span><span class="n">dy</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">[(</span><span class="n">Ca0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">tau</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k0</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E_R</span><span class="o">/</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="k">...</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-55" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-55" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-55"></a><span class="w">                   </span><span class="p">(</span><span class="n">T0</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">tau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">G</span><span class="o">*</span><span class="n">k0</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E_R</span><span class="o">/</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)];</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-56" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-56" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-56"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-57" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-57" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-57"></a><span class="w">        </span><span class="c">% critical points</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-58" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-58" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-58"></a><span class="w">        </span><span class="n">opts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">optimoptions</span><span class="p">(</span><span class="s">'fsolve'</span><span class="p">,</span><span class="s">'Display'</span><span class="p">,</span><span class="s">'off'</span><span class="p">,</span><span class="s">'MaxFunctionEvaluations'</span><span class="p">,</span><span class="mi">3000</span><span class="p">,</span><span class="w"> </span><span class="s">'functiontolerance'</span><span class="p">,</span><span class="mf">1e-6</span><span class="p">);</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-59" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-59" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-59"></a><span class="w">        </span><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">fsolve</span><span class="p">(</span><span class="n">dy</span><span class="p">,[</span><span class="mi">0</span><span class="p">;</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">opts</span><span class="p">),</span><span class="w"> </span><span class="k">...</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-60" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-60" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-60"></a><span class="w">                </span><span class="n">fsolve</span><span class="p">(</span><span class="n">dy</span><span class="p">,[</span><span class="mi">0</span><span class="p">;</span><span class="mi">500</span><span class="p">],</span><span class="w"> </span><span class="n">opts</span><span class="p">),</span><span class="w"> </span><span class="k">...</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-61" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-61" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-61"></a><span class="w">                </span><span class="n">fsolve</span><span class="p">(</span><span class="n">dy</span><span class="p">,[</span><span class="mi">1</span><span class="p">;</span><span class="mi">380</span><span class="p">],</span><span class="w"> </span><span class="n">opts</span><span class="p">)]</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-62" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-62" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-62"></a><span class="w">        </span><span class="nb">j</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">(:,</span><span class="mi">1</span><span class="p">))</span><span class="o">.^</span><span class="mi">2</span><span class="p">))</span><span class="o">&lt;</span><span class="mf">1e-3</span><span class="p">;</span><span class="w"> </span><span class="k">...</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-63" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-63" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-63"></a><span class="w">             </span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">(:,</span><span class="mi">2</span><span class="p">))</span><span class="o">.^</span><span class="mi">2</span><span class="p">))</span><span class="o">&lt;</span><span class="mf">1e-3</span><span class="p">;</span><span class="w"> </span><span class="k">...</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-64" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-64" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-64"></a><span class="w">             </span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">(:,</span><span class="mi">3</span><span class="p">))</span><span class="o">.^</span><span class="mi">2</span><span class="p">))</span><span class="o">&lt;</span><span class="mf">1e-3</span><span class="p">]</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-65" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-65" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-65"></a><span class="w">        </span><span class="nb">disp</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-66" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-66" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-66"></a><span class="w">        </span><span class="n">y0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="nb">j</span><span class="p">);</span><span class="w"> </span><span class="n">x0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">j</span><span class="p">);</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-67" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-67" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-67"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-68" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-68" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-68"></a>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-69" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-69" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-69"></a><span class="w">        </span><span class="c">% plot phase portrait</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-70" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-70" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-70"></a><span class="w">        </span><span class="n">phasePortrait</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span><span class="n">portrait_lim</span><span class="p">{</span><span class="mi">1</span><span class="p">},</span><span class="n">portrait_lim</span><span class="p">{</span><span class="mi">2</span><span class="p">},</span><span class="n">num_curves</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-71" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-71" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-71"></a><span class="w">        </span><span class="nb">hold</span><span class="w"> </span><span class="n">on</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-72" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-72" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-72"></a><span class="w">        </span><span class="nb">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="s">'sr'</span><span class="p">,</span><span class="s">'markerfacecolor'</span><span class="p">,</span><span class="s">'r'</span><span class="p">);</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-73" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-73" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-73"></a><span class="w">        </span><span class="nb">xlabel</span><span class="p">(</span><span class="n">varname</span><span class="p">{</span><span class="mi">1</span><span class="p">});</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="n">varname</span><span class="p">{</span><span class="mi">2</span><span class="p">});</span><span class="w"> </span><span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-74" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-74" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-74"></a><span class="w">        </span><span class="nb">title</span><span class="p">([</span><span class="s">'T0 = '</span><span class="p">,</span><span class="nb">num2str</span><span class="p">(</span><span class="n">T0</span><span class="p">(</span><span class="nb">i</span><span class="p">))])</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-75" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-75" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-75"></a><span class="w">        </span><span class="nb">print</span><span class="p">(</span><span class="s">'-dpng'</span><span class="p">,</span><span class="w"> </span><span class="s">'-r300'</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s">'phase_portrait_'</span><span class="p">,</span><span class="n">ode</span><span class="p">,</span><span class="s">'_'</span><span class="p">,</span><span class="nb">num2str</span><span class="p">(</span><span class="nb">i</span><span class="p">)]);</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-76" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-76" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-76"></a><span class="w">    </span><span class="k">end</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-77" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-77" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-77"></a><span class="k">otherwise</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-78" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-78" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-78"></a><span class="w">  </span><span class="nb">error</span><span class="p">(</span><span class="s">'** select valid model'</span><span class="p">)</span>
<a id="rest_code_3b800cff962c4095a9b921ae721f0b9e-79" name="rest_code_3b800cff962c4095a9b921ae721f0b9e-79" href="#rest_code_3b800cff962c4095a9b921ae721f0b9e-79"></a><span class="k">end</span>
</pre></div>
    </div>
</article><footer id="footer"><p>Contents  2024         <a href="mailto:jonta.teixeira@gmail.com">Jonathan C. Teixeira</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         <a rel="license" href="https://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/4.0/80x15.png"></a><br></p>
            
        </footer>
</div>
    </section><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
   m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
   })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

   ga('create', 'UA-25324596-7', 'auto');
   ga('send', 'pageview');
</script><script src="../assets/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="../assets/js/jquery.timeago.js" type="text/javascript"></script><script src="../assets/js/mathjax.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
