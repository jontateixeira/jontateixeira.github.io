<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="listing code">
<meta name="viewport" content="width=device-width">
<title>Listings for nonlinear dynamics purpose | YHWH Dwells in my heart</title>
<link href="../../assets/css/bitter.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/main.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://jontateixeira.github.io/pages/listings-nonlinear/">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script><meta name="author" content="Jonathan C. Teixeira">
<meta property="og:site_name" content="YHWH Dwells in my heart">
<meta property="og:title" content="Listings for nonlinear dynamics purpose">
<meta property="og:url" content="http://jontateixeira.github.io/pages/listings-nonlinear/">
<meta property="og:description" content="listing code">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-12-10T10:16:20-03:00">
<meta name="author" content="Jonathan C. Teixeira">
<meta property="og:site_name" content="YHWH Dwells in my heart">
<meta property="og:title" content="Listings for nonlinear dynamics purpose">
<meta property="og:url" content="http://jontateixeira.github.io/pages/listings-nonlinear/">
<meta property="og:description" content="listing code">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-12-10T10:16:20-03:00">
<meta name="description" itemprop="description" content="listing code">
</head>
<body>
    <section class="social"><ul>
<li><a href="../../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="https://www.linkedin.com/in/jonathanteixeira/" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/jontateixeira" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/jontateixeira" title="My Github"><i class="icon-github"></i></a></li>
            <li><a href="../courses/index.html" title="Course"><i class="icon-pencil"></i></a></li>
            <li><a href="../../archive.html" title="Archive"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../../rss.xml" title="RSS feed"><i class="icon-rss"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
<article class="storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name">Listings for nonlinear dynamics purpose</h1>

        
    </header><div itemprop="articleBody text">
    <div>
<p>All codes used for produce the nonlinear dynamic posts</p>
<ul class="simple">
<li><p>Plot the phase portrait:</p></li>
</ul>
<p><a class="reference external" href="../../listings/phasePortrait.m.html">phasePortrait.m</a>  <a class="reference external" href="../../listings/phasePortrait.m">(Source)</a></p>
<pre class="code matlab"><a name="rest_code_f6545e4cde2343d7960945974b3696a5-1"></a><span class="k">function</span><span class="w"> </span><span class="nf">phasePortrait</span><span class="p">(</span>fun, lb, ub, n, randomize<span class="p">)</span><span class="w"></span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-2"></a><span class="c">%Create a phase portrait from a two-dimensional system of ode</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-3"></a><span class="c">%</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-4"></a><span class="c">% SYNOPSIS:</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-5"></a><span class="c">%   phasePortrait(fun, lb, ub, n, randomize)</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-6"></a><span class="c">%</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-7"></a><span class="c">% PARAMETERS:</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-8"></a><span class="c">%   fun         - Function handle or function name with the system of ode</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-9"></a><span class="c">%   lb          - lower bound of phase portrait</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-10"></a><span class="c">%   ub          - upper bound of phase portrait</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-11"></a><span class="c">%   n           - number of intial condition of system</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-12"></a><span class="c">%   randomize   - logical variable to randomize the initial points to integrate</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-13"></a><span class="c">%                 the system. OPTIONAL.  Default value == true</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-14"></a><span class="c">%</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-15"></a><span class="c">% RETURNS:</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-16"></a><span class="c">%   phase portrait plot</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-17"></a><span class="c">%</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-18"></a><span class="c">% EXAMPLE:</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-19"></a><span class="c">%</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-20"></a>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-21"></a><span class="k">if</span> <span class="n">nargin</span><span class="o">&lt;</span><span class="mi">4</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-22"></a>  <span class="n">n</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-23"></a>  <span class="n">randomize</span> <span class="p">=</span> <span class="n">true</span><span class="p">;</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-24"></a><span class="k">elseif</span> <span class="n">nargin</span> <span class="o">&lt;</span> <span class="mi">5</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-25"></a>  <span class="n">randomize</span> <span class="p">=</span> <span class="n">true</span><span class="p">;</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-26"></a><span class="k">end</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-27"></a>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-28"></a><span class="n">num</span> <span class="p">=</span> <span class="mi">20</span><span class="p">;</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-29"></a><span class="n">dx</span> <span class="p">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ub</span><span class="o">-</span><span class="n">lb</span><span class="p">)</span><span class="o">/</span><span class="n">num</span><span class="p">;</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-30"></a>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-31"></a><span class="p">[</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">]=</span><span class="nb">meshgrid</span><span class="p">(</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span><span class="n">ub</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span><span class="n">dx</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span><span class="n">ub</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-32"></a>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-33"></a><span class="n">v</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">numel</span><span class="p">(</span><span class="n">x1</span><span class="p">(:)),</span><span class="mi">2</span><span class="p">);</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-34"></a><span class="k">for</span> <span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">x1</span><span class="p">(:))</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-35"></a>   <span class="n">v</span><span class="p">(</span><span class="nb">i</span><span class="p">,:)</span> <span class="p">=</span> <span class="n">fun</span><span class="p">([</span><span class="n">x1</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">x2</span><span class="p">(</span><span class="nb">i</span><span class="p">)]);</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-36"></a><span class="k">end</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-37"></a>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-38"></a><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-39"></a><span class="nb">disp</span><span class="p">(</span><span class="s">'vectorial field'</span><span class="p">)</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-40"></a><span class="n">hold</span> <span class="n">on</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-41"></a><span class="n">quiver</span><span class="p">(</span><span class="n">x1</span><span class="p">(:),</span><span class="n">x2</span><span class="p">(:),</span><span class="n">v</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">v</span><span class="p">(:,</span><span class="mi">2</span><span class="p">));</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-42"></a><span class="k">if</span> <span class="n">randomize</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-43"></a>  <span class="n">u</span><span class="p">=</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">ub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="nb">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-44"></a>  <span class="n">v</span><span class="p">=</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">ub</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="nb">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-45"></a><span class="k">else</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-46"></a>  <span class="n">n</span> <span class="p">=</span> <span class="nb">floor</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-47"></a>  <span class="n">u</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ub</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">n</span><span class="p">);</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-48"></a>  <span class="n">u</span> <span class="p">=</span> <span class="p">[</span><span class="nb">repmat</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">repmat</span><span class="p">(</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="nb">repmat</span><span class="p">(</span><span class="n">ub</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)];</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-49"></a>  <span class="n">v</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ub</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">n</span><span class="p">);</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-50"></a>  <span class="n">v</span> <span class="p">=</span> <span class="p">[</span><span class="nb">repmat</span><span class="p">(</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="nb">repmat</span><span class="p">(</span><span class="n">ub</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="nb">repmat</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)];</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-51"></a><span class="k">end</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-52"></a>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-53"></a><span class="n">funcao</span> <span class="p">=</span> <span class="p">@(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="n">fun</span><span class="p">([</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-54"></a><span class="nb">disp</span><span class="p">(</span><span class="s">'tracing paths ...'</span><span class="p">)</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-55"></a><span class="k">for</span> <span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-56"></a>    <span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">sol</span><span class="p">]=</span><span class="n">ode45</span><span class="p">(</span><span class="n">funcao</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],[</span><span class="n">u</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span><span class="n">v</span><span class="p">(</span><span class="nb">i</span><span class="p">)]);</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-57"></a>    <span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">sol</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span><span class="s">'k'</span><span class="p">);</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-58"></a><span class="k">end</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-59"></a><span class="n">hold</span> <span class="n">off</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-60"></a>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-61"></a><span class="n">xlim</span><span class="p">([</span><span class="n">lb</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">ub</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
<a name="rest_code_f6545e4cde2343d7960945974b3696a5-62"></a><span class="n">ylim</span><span class="p">([</span><span class="n">lb</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">ub</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
</pre>
<ul class="simple">
<li><p>Images of the posts <a class="reference external" href="../../posts/phase-portrait/">Nonlinear dynamics 1: Phase portrait</a>:</p></li>
</ul>
<p><a class="reference external" href="../../listings/post_phase_portrait.m.html">post_phase_portrait.m</a>  <a class="reference external" href="../../listings/post_phase_portrait.m">(Source)</a></p>
<pre class="code matlab"><a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-1"></a><span class="cm">%{</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-2"></a><span class="cm">File: test_phasePortrait.m</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-3"></a><span class="cm">Author: Jonathan C. Teixeira</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-4"></a><span class="cm">Email: jonta.teixeira@gmail.com</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-5"></a><span class="cm">Description: Generate phase portrait of ode system</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-6"></a><span class="cm">%}</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-7"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-8"></a><span class="c">% as usual</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-9"></a><span class="n">clc</span><span class="p">;</span> <span class="n">clear</span><span class="p">;</span> <span class="n">close</span> <span class="n">all</span><span class="p">;</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-10"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-11"></a><span class="n">ode</span> <span class="p">=</span> <span class="s">'nonlinear'</span><span class="p">;</span>    <span class="c">% ode selections: 'linear' or 'nonlinear'</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-12"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-13"></a><span class="k">switch</span> <span class="n">lower</span><span class="p">(</span><span class="n">ode</span><span class="p">)</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-14"></a><span class="k">case</span> <span class="s">'linear'</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-15"></a>    <span class="c">% homogeneous linear system</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-16"></a>    <span class="c">% name of variables</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-17"></a>    <span class="n">varname</span> <span class="p">=</span> <span class="p">{</span><span class="s">'x'</span><span class="p">,</span> <span class="s">'y'</span><span class="p">};</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-18"></a>    <span class="n">portrait_lim</span> <span class="p">=</span> <span class="p">{[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]};</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-19"></a>    <span class="n">num_curves</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-20"></a>    <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">]</span> <span class="p">=</span> <span class="n">deal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-21"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-22"></a>    <span class="n">a</span>   <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">+</span><span class="mi">1</span><span class="p">];</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-23"></a>    <span class="n">b</span>   <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="o">+</span><span class="mi">5</span><span class="p">];</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-24"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-25"></a>    <span class="k">for</span> <span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-26"></a>      <span class="c">% define ode system</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-27"></a>      <span class="n">dy</span> <span class="p">=</span> <span class="p">@(</span><span class="n">x</span><span class="p">)</span> <span class="p">[</span><span class="n">a</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">b</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">))];</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-28"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-29"></a>      <span class="c">% plot phase portrait</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-30"></a>      <span class="n">phasePortrait</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span><span class="n">portrait_lim</span><span class="p">{</span><span class="mi">1</span><span class="p">},</span><span class="n">portrait_lim</span><span class="p">{</span><span class="mi">2</span><span class="p">},</span><span class="n">num_curves</span><span class="p">)</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-31"></a>      <span class="n">hold</span> <span class="n">on</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-32"></a>      <span class="n">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="s">'sr'</span><span class="p">);</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-33"></a>      <span class="n">xlabel</span><span class="p">(</span><span class="n">varname</span><span class="p">{</span><span class="mi">1</span><span class="p">});</span> <span class="n">ylabel</span><span class="p">(</span><span class="n">varname</span><span class="p">{</span><span class="mi">2</span><span class="p">});</span> <span class="n">grid</span> <span class="n">on</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-34"></a>      <span class="n">print</span><span class="p">(</span><span class="s">'-dpng'</span><span class="p">,</span> <span class="s">'-r300'</span><span class="p">,</span> <span class="p">[</span><span class="s">'phase_portrait_'</span><span class="p">,</span><span class="n">ode</span><span class="p">,</span><span class="s">'_'</span><span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="nb">i</span><span class="p">)]);</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-35"></a>    <span class="k">end</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-36"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-37"></a><span class="k">case</span> <span class="s">'nonlinear'</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-38"></a>    <span class="c">%% nonlinear system</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-39"></a>    <span class="c">% parameter definition</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-40"></a>    <span class="n">tau</span> <span class="p">=</span> <span class="mi">60</span><span class="p">;</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-41"></a>    <span class="n">k0</span>  <span class="p">=</span> <span class="mf">1.7e5</span><span class="p">;</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-42"></a>    <span class="n">G</span>   <span class="p">=</span> <span class="mf">90.3</span><span class="p">;</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-43"></a>    <span class="n">E_R</span> <span class="p">=</span> <span class="mi">6307</span><span class="p">;</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-44"></a>    <span class="n">Ca0</span> <span class="p">=</span> <span class="mf">1.5</span><span class="p">;</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-45"></a>    <span class="n">T0</span>  <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="mi">350</span><span class="p">,</span><span class="mi">12</span><span class="p">);</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-46"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-47"></a>    <span class="c">% name of variables</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-48"></a>    <span class="n">varname</span> <span class="p">=</span> <span class="p">{</span><span class="s">'Concentration'</span><span class="p">,</span> <span class="s">'Temperature'</span><span class="p">};</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-49"></a>    <span class="n">portrait_lim</span> <span class="p">=</span> <span class="p">{[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">550</span><span class="p">]};</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-50"></a>    <span class="n">num_curves</span> <span class="p">=</span> <span class="mi">300</span><span class="p">;</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-51"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-52"></a>    <span class="k">for</span> <span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">T0</span><span class="p">)</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-53"></a>        <span class="c">% define ode system</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-54"></a>        <span class="n">dy</span> <span class="p">=</span> <span class="p">@(</span><span class="n">x</span><span class="p">)</span> <span class="p">[(</span><span class="n">Ca0</span> <span class="o">-</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">tau</span> <span class="o">-</span> <span class="n">k0</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E_R</span><span class="o">/</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c">...</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-55"></a>                   <span class="p">(</span><span class="n">T0</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">tau</span> <span class="o">+</span> <span class="n">G</span><span class="o">*</span><span class="n">k0</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E_R</span><span class="o">/</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)];</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-56"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-57"></a>        <span class="c">% critical points</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-58"></a>        <span class="n">opts</span> <span class="p">=</span> <span class="n">optimoptions</span><span class="p">(</span><span class="s">'fsolve'</span><span class="p">,</span><span class="s">'Display'</span><span class="p">,</span><span class="s">'off'</span><span class="p">,</span><span class="s">'MaxFunctionEvaluations'</span><span class="p">,</span><span class="mi">3000</span><span class="p">,</span> <span class="s">'functiontolerance'</span><span class="p">,</span><span class="mf">1e-6</span><span class="p">);</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-59"></a>        <span class="n">x</span> <span class="p">=</span> <span class="p">[</span><span class="n">fsolve</span><span class="p">(</span><span class="n">dy</span><span class="p">,[</span><span class="mi">0</span><span class="p">;</span><span class="mi">0</span><span class="p">],</span> <span class="n">opts</span><span class="p">),</span> <span class="c">...</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-60"></a>                <span class="n">fsolve</span><span class="p">(</span><span class="n">dy</span><span class="p">,[</span><span class="mi">0</span><span class="p">;</span><span class="mi">500</span><span class="p">],</span> <span class="n">opts</span><span class="p">),</span> <span class="c">...</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-61"></a>                <span class="n">fsolve</span><span class="p">(</span><span class="n">dy</span><span class="p">,[</span><span class="mi">1</span><span class="p">;</span><span class="mi">380</span><span class="p">],</span> <span class="n">opts</span><span class="p">)]</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-62"></a>        <span class="nb">j</span> <span class="p">=</span> <span class="p">[</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">sum</span><span class="p">(</span><span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">(:,</span><span class="mi">1</span><span class="p">))</span><span class="o">.^</span><span class="mi">2</span><span class="p">))</span><span class="o">&lt;</span><span class="mf">1e-3</span><span class="p">;</span> <span class="c">...</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-63"></a>             <span class="nb">sqrt</span><span class="p">(</span><span class="n">sum</span><span class="p">(</span><span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">(:,</span><span class="mi">2</span><span class="p">))</span><span class="o">.^</span><span class="mi">2</span><span class="p">))</span><span class="o">&lt;</span><span class="mf">1e-3</span><span class="p">;</span> <span class="c">...</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-64"></a>             <span class="nb">sqrt</span><span class="p">(</span><span class="n">sum</span><span class="p">(</span><span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">(:,</span><span class="mi">3</span><span class="p">))</span><span class="o">.^</span><span class="mi">2</span><span class="p">))</span><span class="o">&lt;</span><span class="mf">1e-3</span><span class="p">]</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-65"></a>        <span class="nb">disp</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-66"></a>        <span class="n">y0</span> <span class="p">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="nb">j</span><span class="p">);</span> <span class="n">x0</span> <span class="p">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">j</span><span class="p">);</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-67"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-68"></a>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-69"></a>        <span class="c">% plot phase portrait</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-70"></a>        <span class="n">phasePortrait</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span><span class="n">portrait_lim</span><span class="p">{</span><span class="mi">1</span><span class="p">},</span><span class="n">portrait_lim</span><span class="p">{</span><span class="mi">2</span><span class="p">},</span><span class="n">num_curves</span><span class="p">,</span> <span class="n">false</span><span class="p">)</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-71"></a>        <span class="n">hold</span> <span class="n">on</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-72"></a>        <span class="n">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="s">'sr'</span><span class="p">,</span><span class="s">'markerfacecolor'</span><span class="p">,</span><span class="s">'r'</span><span class="p">);</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-73"></a>        <span class="n">xlabel</span><span class="p">(</span><span class="n">varname</span><span class="p">{</span><span class="mi">1</span><span class="p">});</span> <span class="n">ylabel</span><span class="p">(</span><span class="n">varname</span><span class="p">{</span><span class="mi">2</span><span class="p">});</span> <span class="n">grid</span> <span class="n">on</span><span class="p">;</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-74"></a>        <span class="n">title</span><span class="p">([</span><span class="s">'T0 = '</span><span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="n">T0</span><span class="p">(</span><span class="nb">i</span><span class="p">))])</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-75"></a>        <span class="n">print</span><span class="p">(</span><span class="s">'-dpng'</span><span class="p">,</span> <span class="s">'-r300'</span><span class="p">,</span> <span class="p">[</span><span class="s">'phase_portrait_'</span><span class="p">,</span><span class="n">ode</span><span class="p">,</span><span class="s">'_'</span><span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="nb">i</span><span class="p">)]);</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-76"></a>    <span class="k">end</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-77"></a><span class="k">otherwise</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-78"></a>  <span class="n">error</span><span class="p">(</span><span class="s">'** select valid model'</span><span class="p">)</span>
<a name="rest_code_02dac8fb9e654332b91fc9d819686aa1-79"></a><span class="k">end</span>
</pre>
</div>
    </div>
</article><footer id="footer"><p>Contents © 2019         <a href="mailto:jonta.teixeira@gmail.com">Jonathan C. Teixeira</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         <a rel="license" href="https://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/4.0/80x15.png"></a><br></p>
            
        </footer>
</div>
    </section><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
   m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
   })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

   ga('create', 'UA-25324596-7', 'auto');
   ga('send', 'pageview');
</script><script src="../../assets/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="../../assets/js/jquery.timeago.js" type="text/javascript"></script><script src="../../assets/js/mathjax.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
